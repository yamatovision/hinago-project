<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>収益性試算 | 土地購入意思決定支援システム</title>
  <!-- Material UI -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mui/material@5.14.5/dist/material-ui.min.css">
  <!-- Chart.js for visualization -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <!-- jsPDF for PDF generation -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <!-- html2canvas for PDF export -->
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f5f5f5;
      color: #333;
    }
    
    .app-container {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    
    header {
      background-color: #1976d2;
      color: white;
      padding: 0 16px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 64px;
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .logo {
      font-size: 1.25rem;
      font-weight: 500;
      text-decoration: none;
      color: white;
      display: flex;
      align-items: center;
    }
    
    .logo .material-icons {
      margin-right: 8px;
    }
    
    nav {
      display: flex;
      align-items: center;
    }
    
    .nav-link {
      color: white;
      text-decoration: none;
      padding: 0 16px;
      height: 64px;
      display: flex;
      align-items: center;
      transition: background-color 0.3s;
    }
    
    .nav-link:hover, .nav-link.active {
      background-color: rgba(255,255,255,0.1);
    }
    
    .user-menu {
      display: flex;
      align-items: center;
    }
    
    main {
      flex: 1;
      padding: 24px;
      max-width: 1280px;
      margin: 0 auto;
      width: 100%;
      box-sizing: border-box;
    }
    
    .page-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    
    .page-title {
      font-size: 1.5rem;
      font-weight: 500;
      margin: 0;
    }
    
    .card {
      background-color: white;
      border-radius: 8px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      margin-bottom: 24px;
      overflow: hidden;
    }
    
    .card-header {
      padding: 16px;
      border-bottom: 1px solid #eeeeee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .card-title {
      margin: 0;
      font-size: 1.25rem;
      font-weight: 500;
    }
    
    .card-content {
      padding: 24px;
    }
    
    .form-section {
      margin-bottom: 32px;
    }
    
    .section-title {
      font-size: 1.1rem;
      font-weight: 500;
      margin: 0 0 16px 0;
      color: #1976d2;
      display: flex;
      align-items: center;
    }
    
    .section-title .material-icons {
      font-size: 20px;
      margin-right: 8px;
    }
    
    .section-description {
      font-size: 0.9rem;
      color: #666;
      margin-top: 4px;
      margin-bottom: 16px;
    }
    
    .two-column {
      display: flex;
      gap: 24px;
    }
    
    .column {
      flex: 1;
    }
    
    .form-row {
      margin-bottom: 24px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
    }
    
    .form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
      box-sizing: border-box;
      transition: border-color 0.3s;
    }
    
    .form-input:focus {
      outline: none;
      border-color: #1976d2;
      box-shadow: 0 0 0 2px rgba(25, 118, 210, 0.2);
    }
    
    .form-select {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 1rem;
      background-color: white;
      box-sizing: border-box;
      appearance: none;
      background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%23333'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
      background-repeat: no-repeat;
      background-position: right 12px center;
      background-size: 20px;
    }
    
    .form-helper {
      font-size: 0.8rem;
      color: #666;
      margin-top: 4px;
    }
    
    .form-error {
      font-size: 0.8rem;
      color: #d32f2f;
      margin-top: 4px;
    }
    
    .button {
      background-color: #1976d2;
      color: white;
      border: none;
      border-radius: 4px;
      padding: 12px 24px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      transition: background-color 0.3s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    .button:hover {
      background-color: #1565c0;
    }
    
    .button.secondary {
      background-color: #f5f5f5;
      color: #333;
      border: 1px solid #ddd;
    }
    
    .button.secondary:hover {
      background-color: #e0e0e0;
    }
    
    .button .material-icons {
      font-size: 18px;
      margin-right: 8px;
    }
    
    .button-group {
      display: flex;
      gap: 12px;
    }
    
    .actions {
      display: flex;
      justify-content: center;
      margin-top: 32px;
    }
    
    .info-tooltip {
      color: #1976d2;
      font-size: 16px;
      vertical-align: middle;
      margin-left: 4px;
      cursor: help;
    }
    
    .required-label::after {
      content: "*";
      color: #d32f2f;
      margin-left: 4px;
    }
    
    .sub-fields {
      background-color: #f9f9f9;
      border-radius: 4px;
      padding: 16px;
      margin-top: 8px;
    }
    
    .input-group {
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .input-group .form-input {
      flex: 1;
    }
    
    .input-group .unit {
      flex-shrink: 0;
      color: #666;
    }
    
    .asset-type-selector {
      display: flex;
      gap: 16px;
      margin-bottom: 24px;
      flex-wrap: wrap;
    }
    
    .asset-type-option {
      background-color: white;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 16px;
      cursor: pointer;
      flex: 1;
      min-width: 120px;
      text-align: center;
      transition: all 0.3s;
    }
    
    .asset-type-option:hover {
      border-color: #1976d2;
    }
    
    .asset-type-option.selected {
      border-color: #1976d2;
      background-color: #e3f2fd;
    }
    
    .asset-type-option .icon {
      font-size: 32px;
      margin-bottom: 8px;
      color: #1976d2;
    }
    
    .asset-type-option .label {
      font-weight: 500;
    }
    
    .summary-card {
      background-color: #e3f2fd;
      border-radius: 4px;
      padding: 16px;
      margin-bottom: 24px;
    }
    
    .summary-item {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
      font-size: 0.9rem;
    }
    
    .summary-item.total {
      font-weight: 500;
      border-top: 1px solid #ccc;
      padding-top: 8px;
      margin-top: 8px;
      font-size: 1rem;
    }
    
    .summary-label {
      color: #555;
    }
    
    .summary-value {
      font-weight: 500;
    }
    
    .metrics-panel {
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .metric-card {
      background-color: white;
      border-radius: 4px;
      padding: 16px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
      flex: 1;
      min-width: 200px;
    }
    
    .metric-title {
      font-size: 0.875rem;
      font-weight: 500;
      color: #666;
      margin: 0 0 8px 0;
    }
    
    .metric-value {
      font-size: 1.5rem;
      font-weight: 500;
      margin: 0;
    }
    
    .metric-info {
      font-size: 0.75rem;
      color: #666;
      margin: 4px 0 0 0;
    }
    
    .metric-positive {
      color: #4caf50;
    }
    
    .metric-negative {
      color: #f44336;
    }
    
    .chart-container {
      height: 300px;
      margin-bottom: 32px;
    }
    
    .table-container {
      overflow-x: auto;
      margin-bottom: 32px;
    }
    
    .data-table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .data-table th,
    .data-table td {
      padding: 12px;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    .data-table th {
      background-color: #f5f5f5;
      font-weight: 500;
      color: #333;
    }
    
    .data-table tr:last-child td {
      border-bottom: none;
    }
    
    .data-table tr:hover td {
      background-color: #f9f9f9;
    }
    
    .tab-container {
      margin-top: 24px;
    }
    
    .tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
    }
    
    .tab {
      padding: 12px 24px;
      cursor: pointer;
      transition: all 0.3s;
      border-bottom: 2px solid transparent;
      font-weight: 500;
    }
    
    .tab.active {
      border-bottom-color: #1976d2;
      color: #1976d2;
    }
    
    .tab-content {
      padding: 24px 0;
    }
    
    .hidden {
      display: none;
    }
    
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(255,255,255,0.8);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    
    .spinner {
      width: 40px;
      height: 40px;
      border: 4px solid #f3f3f3;
      border-top: 4px solid #1976d2;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin-bottom: 16px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    .property-selector {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .property-selector-label {
      font-weight: 500;
      min-width: 80px;
    }
    
    .property-selector-input {
      flex: 1;
    }
    
    .slider-container {
      margin-bottom: 16px;
    }
    
    .slider-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
    }
    
    .slider-label {
      font-weight: 500;
      font-size: 0.9rem;
    }
    
    .slider-value {
      font-weight: 500;
      color: #1976d2;
    }
    
    .slider {
      -webkit-appearance: none;
      width: 100%;
      height: 4px;
      border-radius: 2px;
      background: #ddd;
      outline: none;
    }
    
    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #1976d2;
      cursor: pointer;
    }
    
    .slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #1976d2;
      cursor: pointer;
      border: none;
    }
    
    .result-container {
      margin-top: 32px;
    }
    
    .result-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
    }
    
    .result-title {
      font-size: 1.25rem;
      font-weight: 500;
      margin: 0;
    }
    
    .result-actions {
      display: flex;
      gap: 12px;
    }
    
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 0.75rem;
      font-weight: 500;
      margin-left: 8px;
    }
    
    .badge.high {
      background-color: #e3f2fd;
      color: #1976d2;
    }
    
    .badge.medium {
      background-color: #fff8e1;
      color: #ff8f00;
    }
    
    .badge.low {
      background-color: #ffebee;
      color: #d32f2f;
    }
    
    .scenario-container {
      margin-bottom: 32px;
    }
    
    .scenario-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 16px;
    }
    
    .scenario-actions {
      display: flex;
      gap: 8px;
    }
    
    .scenario-tabs {
      display: flex;
      border-bottom: 1px solid #ddd;
      margin-bottom: 24px;
    }
    
    .scenario-tab {
      padding: 12px 24px;
      cursor: pointer;
      transition: all 0.3s;
      border-bottom: 2px solid transparent;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .scenario-tab.active {
      border-bottom-color: #1976d2;
      color: #1976d2;
    }
    
    .scenario-tab-content {
      display: none;
    }
    
    .scenario-tab-content.active {
      display: block;
    }
    
    @media (max-width: 768px) {
      .two-column {
        flex-direction: column;
      }
      
      .metrics-panel {
        flex-direction: column;
      }
      
      .metric-card {
        width: 100%;
      }
      
      .asset-type-selector {
        flex-direction: column;
      }
      
      .property-selector {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .property-selector-input {
        width: 100%;
      }
      
      .scenario-tabs {
        flex-wrap: wrap;
      }
      
      .button-group {
        flex-direction: column;
      }
    }
  </style>
</head>
<body>
  <div class="app-container">
    <header>
      <a href="#" class="logo">
        <span class="material-icons">business</span>
        Hinago
      </a>
      <nav>
        <a href="#" class="nav-link">ダッシュボード</a>
        <a href="#" class="nav-link">物件登録</a>
        <a href="#" class="nav-link">ボリュームチェック</a>
        <a href="#" class="nav-link active">収益性試算</a>
      </nav>
      <div class="user-menu">
        <a href="#" class="nav-link">
          <span class="material-icons">account_circle</span>
        </a>
      </div>
    </header>
    
    <main>
      <div class="page-header">
        <h1 class="page-title">収益性試算</h1>
        <div class="button-group">
          <button class="button secondary">
            <span class="material-icons">save</span>
            保存
          </button>
          <button class="button secondary">
            <span class="material-icons">picture_as_pdf</span>
            PDF出力
          </button>
        </div>
      </div>
      
      <div class="property-selector">
        <div class="property-selector-label">物件選択</div>
        <div class="property-selector-input">
          <select class="form-select" id="property-select">
            <option value="property1">東区山鹿A区画</option>
            <option value="property2">博多駅前B棟</option>
            <option value="property3">西区周船寺区画C</option>
          </select>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">物件情報</h2>
        </div>
        <div class="card-content">
          <div class="two-column">
            <div class="column">
              <div class="form-row">
                <label class="form-label">物件名</label>
                <div>東区山鹿A区画</div>
              </div>
              <div class="form-row">
                <label class="form-label">住所</label>
                <div>福岡市東区山鹿2-3-4</div>
              </div>
              <div class="form-row">
                <label class="form-label">敷地面積</label>
                <div>330 m²</div>
              </div>
            </div>
            <div class="column">
              <div class="form-row">
                <label class="form-label">用途地域</label>
                <div>商業地域</div>
              </div>
              <div class="form-row">
                <label class="form-label">建蔽率 / 容積率</label>
                <div>80% / 400%</div>
              </div>
              <div class="form-row">
                <label class="form-label">取得価格</label>
                <div>50,000,000 円（坪単価約 500,000 円）</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">ボリュームチェック結果</h2>
        </div>
        <div class="card-content">
          <div class="two-column">
            <div class="column">
              <div class="form-row">
                <label class="form-label">最大建築可能ボリューム</label>
                <div>1,320 m²</div>
              </div>
              <div class="form-row">
                <label class="form-label">実現可能床面積</label>
                <div>1,155 m²</div>
              </div>
              <div class="form-row">
                <label class="form-label">容積消化率</label>
                <div>87.5%</div>
              </div>
            </div>
            <div class="column">
              <div class="form-row">
                <label class="form-label">階数</label>
                <div>10階</div>
              </div>
              <div class="form-row">
                <label class="form-label">建築面積</label>
                <div>120 m²</div>
              </div>
              <div class="form-row">
                <label class="form-label">アセットタイプ</label>
                <div>オフィス</div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">収益性試算パラメータ</h2>
        </div>
        <div class="card-content">
          <div class="asset-type-selector">
            <div class="asset-type-option" data-type="mansion">
              <div class="icon">
                <span class="material-icons">apartment</span>
              </div>
              <div class="label">マンション</div>
            </div>
            <div class="asset-type-option selected" data-type="office">
              <div class="icon">
                <span class="material-icons">business</span>
              </div>
              <div class="label">オフィス</div>
            </div>
            <div class="asset-type-option" data-type="wooden-apartment">
              <div class="icon">
                <span class="material-icons">home</span>
              </div>
              <div class="label">木造アパート</div>
            </div>
            <div class="asset-type-option" data-type="hotel">
              <div class="icon">
                <span class="material-icons">hotel</span>
              </div>
              <div class="label">ホテル</div>
            </div>
          </div>
          
          <div class="scenario-tabs">
            <div class="scenario-tab active" data-tab="scenario1">
              <span class="material-icons">looks_one</span>
              シナリオ1
            </div>
            <div class="scenario-tab" data-tab="scenario2">
              <span class="material-icons">looks_two</span>
              シナリオ2
            </div>
            <div class="scenario-tab" data-tab="scenario3">
              <span class="material-icons">looks_3</span>
              シナリオ3
            </div>
            <div class="scenario-tab" data-tab="new">
              <span class="material-icons">add</span>
              新規シナリオ
            </div>
          </div>
          
          <div class="scenario-tab-content active" id="scenario1-content">
            <div class="two-column">
              <div class="column">
                <h3 class="section-title">
                  <span class="material-icons">attach_money</span>
                  収益パラメータ
                </h3>
                
                <div class="form-row">
                  <label class="form-label" for="rent-per-sqm">賃料単価</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">低め</span>
                      <span class="slider-value">3,500 円/m²</span>
                      <span class="slider-label">高め</span>
                    </div>
                    <input type="range" min="2000" max="5000" value="3500" class="slider" id="rent-per-sqm">
                  </div>
                </div>
                
                <div class="form-row">
                  <label class="form-label" for="occupancy-rate">稼働率</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">低め</span>
                      <span class="slider-value">95%</span>
                      <span class="slider-label">高め</span>
                    </div>
                    <input type="range" min="70" max="100" value="95" class="slider" id="occupancy-rate">
                  </div>
                </div>
                
                <div class="form-row">
                  <label class="form-label" for="management-cost">管理コスト率</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">低め</span>
                      <span class="slider-value">15%</span>
                      <span class="slider-label">高め</span>
                    </div>
                    <input type="range" min="10" max="30" value="15" class="slider" id="management-cost">
                  </div>
                </div>
              </div>
              
              <div class="column">
                <h3 class="section-title">
                  <span class="material-icons">construction</span>
                  建築パラメータ
                </h3>
                
                <div class="form-row">
                  <label class="form-label" for="construction-cost">建設単価</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">低め</span>
                      <span class="slider-value">400,000 円/m²</span>
                      <span class="slider-label">高め</span>
                    </div>
                    <input type="range" min="300000" max="600000" value="400000" class="slider" id="construction-cost">
                  </div>
                </div>
                
                <div class="form-row">
                  <label class="form-label" for="rental-period">運用期間</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">短期</span>
                      <span class="slider-value">20年</span>
                      <span class="slider-label">長期</span>
                    </div>
                    <input type="range" min="10" max="30" value="20" class="slider" id="rental-period">
                  </div>
                </div>
                
                <div class="form-row">
                  <label class="form-label" for="cap-rate">還元利回り</label>
                  <div class="slider-container">
                    <div class="slider-header">
                      <span class="slider-label">低め</span>
                      <span class="slider-value">4.0%</span>
                      <span class="slider-label">高め</span>
                    </div>
                    <input type="range" min="3" max="6" step="0.1" value="4.0" class="slider" id="cap-rate">
                  </div>
                </div>
              </div>
            </div>
            
            <div class="actions">
              <button class="button" id="calculate-btn">
                <span class="material-icons">calculate</span>
                収益性試算実行
              </button>
            </div>
          </div>
          
          <div class="scenario-tab-content" id="scenario2-content">
            <!-- シナリオ2のコンテンツ -->
            <div class="two-column">
              <!-- シナリオ2のパラメータ入力フォーム -->
            </div>
          </div>
          
          <div class="scenario-tab-content" id="scenario3-content">
            <!-- シナリオ3のコンテンツ -->
            <div class="two-column">
              <!-- シナリオ3のパラメータ入力フォーム -->
            </div>
          </div>
        </div>
      </div>
      
      <div id="results" class="result-container hidden">
        <div class="result-header">
          <h2 class="result-title">収益性分析結果 <span class="badge high">高収益</span></h2>
          <div class="result-actions">
            <button class="button secondary">
              <span class="material-icons">edit</span>
              パラメータ編集
            </button>
            <button class="button secondary">
              <span class="material-icons">refresh</span>
              再計算
            </button>
          </div>
        </div>
        
        <div class="metrics-panel">
          <div class="metric-card">
            <div class="metric-title">投資利回り (NOI)</div>
            <div class="metric-value metric-positive">5.8%</div>
            <div class="metric-info">年間純収益 ÷ 総投資額</div>
          </div>
          <div class="metric-card">
            <div class="metric-title">IRR (内部収益率)</div>
            <div class="metric-value metric-positive">6.2%</div>
            <div class="metric-info">20年間のキャッシュフロー</div>
          </div>
          <div class="metric-card">
            <div class="metric-title">投資回収期間</div>
            <div class="metric-value">14.3年</div>
            <div class="metric-info">初期投資の回収に要する期間</div>
          </div>
          <div class="metric-card">
            <div class="metric-title">NPV (正味現在価値)</div>
            <div class="metric-value metric-positive">58,500,000円</div>
            <div class="metric-info">割引率4.0%で計算</div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">収支概要</h2>
          </div>
          <div class="card-content">
            <div class="two-column">
              <div class="column">
                <h3 class="section-title">
                  <span class="material-icons">savings</span>
                  初期投資
                </h3>
                <div class="summary-card">
                  <div class="summary-item">
                    <div class="summary-label">土地取得費</div>
                    <div class="summary-value">50,000,000円</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">建設費</div>
                    <div class="summary-value">462,000,000円</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">諸経費</div>
                    <div class="summary-value">15,000,000円</div>
                  </div>
                  <div class="summary-item total">
                    <div class="summary-label">総投資額</div>
                    <div class="summary-value">527,000,000円</div>
                  </div>
                </div>
              </div>
              <div class="column">
                <h3 class="section-title">
                  <span class="material-icons">account_balance</span>
                  年間収支
                </h3>
                <div class="summary-card">
                  <div class="summary-item">
                    <div class="summary-label">年間賃料収入</div>
                    <div class="summary-value">45,690,000円</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">運営費</div>
                    <div class="summary-value">-6,853,500円</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">修繕費</div>
                    <div class="summary-value">-2,284,500円</div>
                  </div>
                  <div class="summary-item">
                    <div class="summary-label">不動産税</div>
                    <div class="summary-value">-5,270,000円</div>
                  </div>
                  <div class="summary-item total">
                    <div class="summary-label">年間純収益(NOI)</div>
                    <div class="summary-value">31,282,000円</div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="chart-container">
              <canvas id="cash-flow-chart"></canvas>
            </div>
            
            <div class="table-container">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>年次</th>
                    <th>賃料収入</th>
                    <th>運営支出</th>
                    <th>年間純収益</th>
                    <th>累計収益</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td>1年目</td>
                    <td>45,690,000円</td>
                    <td>-14,408,000円</td>
                    <td>31,282,000円</td>
                    <td>31,282,000円</td>
                  </tr>
                  <tr>
                    <td>2年目</td>
                    <td>46,375,350円</td>
                    <td>-14,624,120円</td>
                    <td>31,751,230円</td>
                    <td>63,033,230円</td>
                  </tr>
                  <tr>
                    <td>3年目</td>
                    <td>47,070,980円</td>
                    <td>-14,843,482円</td>
                    <td>32,227,498円</td>
                    <td>95,260,728円</td>
                  </tr>
                  <tr>
                    <td>4年目</td>
                    <td>47,777,045円</td>
                    <td>-15,066,134円</td>
                    <td>32,710,911円</td>
                    <td>127,971,639円</td>
                  </tr>
                  <tr>
                    <td>5年目</td>
                    <td>48,493,700円</td>
                    <td>-15,292,126円</td>
                    <td>33,201,574円</td>
                    <td>161,173,213円</td>
                  </tr>
                  <tr>
                    <td colspan="5" style="text-align: center;">
                      <button class="button secondary" style="margin-top: 8px;">
                        <span class="material-icons">expand_more</span>
                        全期間を表示
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">感度分析</h2>
          </div>
          <div class="card-content">
            <div class="tab-container">
              <div class="tabs">
                <div class="tab active" data-tab="irr-analysis">IRR分析</div>
                <div class="tab" data-tab="noi-analysis">NOI分析</div>
                <div class="tab" data-tab="npv-analysis">NPV分析</div>
              </div>
              
              <div class="tab-content" id="irr-analysis-tab">
                <div class="chart-container">
                  <canvas id="irr-sensitivity-chart"></canvas>
                </div>
              </div>
              
              <div class="tab-content hidden" id="noi-analysis-tab">
                <div class="chart-container">
                  <canvas id="noi-sensitivity-chart"></canvas>
                </div>
              </div>
              
              <div class="tab-content hidden" id="npv-analysis-tab">
                <div class="chart-container">
                  <canvas id="npv-sensitivity-chart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
  
  <script>
    // DOM要素の取得
    const calculateBtn = document.getElementById('calculate-btn');
    const resultsSection = document.getElementById('results');
    const assetTypeOptions = document.querySelectorAll('.asset-type-option');
    const tabs = document.querySelectorAll('.tab');
    const tabContents = document.querySelectorAll('.tab-content');
    const scenarioTabs = document.querySelectorAll('.scenario-tab');
    const scenarioContents = document.querySelectorAll('.scenario-tab-content');
    
    // スライダー入力値の表示更新
    const sliders = document.querySelectorAll('.slider');
    
    sliders.forEach(slider => {
      const valueDisplay = slider.parentElement.querySelector('.slider-value');
      
      slider.addEventListener('input', () => {
        const value = slider.value;
        let displayValue = value;
        
        // スライダーIDに基づいて適切なフォーマットで値を表示
        switch(slider.id) {
          case 'rent-per-sqm':
            displayValue = Number(value).toLocaleString() + ' 円/m²';
            break;
          case 'occupancy-rate':
            displayValue = value + '%';
            break;
          case 'management-cost':
            displayValue = value + '%';
            break;
          case 'construction-cost':
            displayValue = Number(value).toLocaleString() + ' 円/m²';
            break;
          case 'rental-period':
            displayValue = value + '年';
            break;
          case 'cap-rate':
            displayValue = value + '%';
            break;
          default:
            displayValue = value;
        }
        
        valueDisplay.textContent = displayValue;
      });
    });
    
    // アセットタイプ選択
    assetTypeOptions.forEach(option => {
      option.addEventListener('click', () => {
        assetTypeOptions.forEach(opt => opt.classList.remove('selected'));
        option.classList.add('selected');
        
        // アセットタイプに応じてデフォルト値を設定
        const type = option.dataset.type;
        
        // 賃料単価スライダー
        const rentSlider = document.getElementById('rent-per-sqm');
        const rentValue = rentSlider.parentElement.querySelector('.slider-value');
        
        // 建設単価スライダー
        const constructionSlider = document.getElementById('construction-cost');
        const constructionValue = constructionSlider.parentElement.querySelector('.slider-value');
        
        // 管理コスト率スライダー
        const managementSlider = document.getElementById('management-cost');
        const managementValue = managementSlider.parentElement.querySelector('.slider-value');
        
        if (type === 'mansion') {
          rentSlider.value = 2800;
          rentValue.textContent = '2,800 円/m²';
          
          constructionSlider.value = 450000;
          constructionValue.textContent = '450,000 円/m²';
          
          managementSlider.value = 18;
          managementValue.textContent = '18%';
        } else if (type === 'office') {
          rentSlider.value = 3500;
          rentValue.textContent = '3,500 円/m²';
          
          constructionSlider.value = 400000;
          constructionValue.textContent = '400,000 円/m²';
          
          managementSlider.value = 15;
          managementValue.textContent = '15%';
        } else if (type === 'wooden-apartment') {
          rentSlider.value = 2100;
          rentValue.textContent = '2,100 円/m²';
          
          constructionSlider.value = 280000;
          constructionValue.textContent = '280,000 円/m²';
          
          managementSlider.value = 20;
          managementValue.textContent = '20%';
        } else if (type === 'hotel') {
          rentSlider.value = 4500;
          rentValue.textContent = '4,500 円/m²';
          
          constructionSlider.value = 550000;
          constructionValue.textContent = '550,000 円/m²';
          
          managementSlider.value = 25;
          managementValue.textContent = '25%';
        }
      });
    });
    
    // タブ切り替え
    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const tabId = tab.dataset.tab;
        
        tabs.forEach(t => t.classList.remove('active'));
        tabContents.forEach(content => content.classList.add('hidden'));
        
        tab.classList.add('active');
        document.getElementById(`${tabId}-tab`).classList.remove('hidden');
      });
    });
    
    // シナリオタブ切り替え
    scenarioTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const tabId = tab.dataset.tab;
        
        // 新規シナリオタブの場合は別処理
        if (tabId === 'new') {
          alert('新しいシナリオを作成します');
          return;
        }
        
        scenarioTabs.forEach(t => t.classList.remove('active'));
        scenarioContents.forEach(content => content.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById(`${tabId}-content`).classList.add('active');
      });
    });
    
    // 収益性試算実行
    calculateBtn.addEventListener('click', () => {
      // ローディング表示
      const loadingOverlay = document.createElement('div');
      loadingOverlay.className = 'loading-overlay';
      
      const spinner = document.createElement('div');
      spinner.className = 'spinner';
      
      const loadingText = document.createElement('div');
      loadingText.textContent = '計算中...';
      
      loadingOverlay.appendChild(spinner);
      loadingOverlay.appendChild(loadingText);
      
      document.body.appendChild(loadingOverlay);
      
      // 計算処理（実際はAPIリクエスト）をシミュレート
      setTimeout(() => {
        // ローディング表示を削除
        document.body.removeChild(loadingOverlay);
        
        // 結果表示
        resultsSection.classList.remove('hidden');
        
        // 結果までスクロール
        resultsSection.scrollIntoView({ behavior: 'smooth' });
        
        // グラフ初期化
        initCharts();
      }, 1500);
    });
    
    // グラフ初期化
    function initCharts() {
      // キャッシュフローチャート
      const cashFlowCtx = document.getElementById('cash-flow-chart').getContext('2d');
      
      const cashFlowData = {
        labels: Array.from({length: 20}, (_, i) => `${i+1}年目`),
        datasets: [
          {
            label: '年間純収益',
            data: [
              31.28, 31.75, 32.23, 32.71, 33.20, 
              33.70, 34.20, 34.72, 35.24, 35.77, 
              36.31, 36.85, 37.40, 37.96, 38.53, 
              39.11, 39.70, 40.29, 40.89, 41.51
            ],
            backgroundColor: 'rgba(25, 118, 210, 0.4)',
            borderColor: 'rgba(25, 118, 210, 1)',
            borderWidth: 1
          },
          {
            label: '累計収益',
            data: [
              31.28, 63.03, 95.26, 127.97, 161.17, 
              194.87, 229.07, 263.79, 299.03, 334.80, 
              371.11, 407.96, 445.36, 483.32, 521.85, 
              560.96, 600.66, 640.95, 681.84, 723.35
            ],
            backgroundColor: 'rgba(46, 125, 50, 0.1)',
            borderColor: 'rgba(46, 125, 50, 1)',
            borderWidth: 1,
            type: 'line',
            yAxisID: 'y1'
          }
        ]
      };
      
      const cashFlowOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          title: {
            display: true,
            text: '20年間のキャッシュフロー推移',
            font: {
              size: 16
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.dataset.label + ': ' + context.raw + ' 百万円';
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: '年間純収益 (百万円)'
            }
          },
          y1: {
            position: 'right',
            beginAtZero: true,
            title: {
              display: true,
              text: '累計収益 (百万円)'
            },
            grid: {
              drawOnChartArea: false
            }
          }
        }
      };
      
      new Chart(cashFlowCtx, {
        type: 'bar',
        data: cashFlowData,
        options: cashFlowOptions
      });
      
      // IRR感度分析チャート
      const irrCtx = document.getElementById('irr-sensitivity-chart').getContext('2d');
      
      const irrData = {
        labels: ['賃料-10%', '賃料-5%', '基本ケース', '賃料+5%', '賃料+10%'],
        datasets: [
          {
            label: '建設費+10%',
            data: [4.1, 4.8, 5.5, 6.1, 6.8],
            backgroundColor: 'rgba(211, 47, 47, 0.6)',
            borderColor: 'rgba(211, 47, 47, 1)',
            borderWidth: 1
          },
          {
            label: '建設費±0%',
            data: [4.8, 5.5, 6.2, 6.8, 7.5],
            backgroundColor: 'rgba(25, 118, 210, 0.6)',
            borderColor: 'rgba(25, 118, 210, 1)',
            borderWidth: 1
          },
          {
            label: '建設費-10%',
            data: [5.5, 6.2, 6.9, 7.6, 8.3],
            backgroundColor: 'rgba(46, 125, 50, 0.6)',
            borderColor: 'rgba(46, 125, 50, 1)',
            borderWidth: 1
          }
        ]
      };
      
      const irrOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          title: {
            display: true,
            text: 'IRR感度分析（賃料と建設費の変動による影響）',
            font: {
              size: 16
            }
          },
          tooltip: {
            callbacks: {
              label: function(context) {
                return context.dataset.label + ': ' + context.raw + '%';
              }
            }
          }
        },
        scales: {
          y: {
            beginAtZero: true,
            title: {
              display: true,
              text: 'IRR (%)'
            },
            suggestedMin: 4,
            suggestedMax: 9
          }
        }
      };
      
      new Chart(irrCtx, {
        type: 'bar',
        data: irrData,
        options: irrOptions
      });
    }
  </script>
</body>
</html>